<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>장바구니</title>
    <link rel="stylesheet" href="../Main/banner/banner.css">
    <style>
        .cartList-image {
            top:38% !important;
        }
        .cartList-imageHolder {
            border: 0px solid #dfdfdf !important;
        }
    </style>
</head>
    <br>
    <br><br><br>
    <div class="container">
        <h1 class="jemoc"></h1>
    </div>
<body>
    <div class="art-rental-landing">
        <header class="header">
            <nav class="main-nav">
                <div class="logo">
                    <a href="/">
    
                        <img src="../images/logo.png" alt="ADAM Logo" width="110" height="44">
                    </a>
                </div>
                <ul class="nav-items main-menu">
                    <li class="nav-item"><a href="../artist/artist.html">작가</a></li>
                    <li class="nav-item has-submenu"><a>구매,대여</a></li>
                    <li class="nav-item has-submenu"><a href="../product/discover.html">작품보기</a></li>
                    <li class="nav-item"><a id="mypage-link" href="#">마이페이지</a></li>
                </ul>
                <div class="icon-group">
                    <a href="../cart/rentalcart.html" class="icon-btn">
                        <svg xmlns="../images/cart.jpg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="cart-icon">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                    </a>
                </div>
                <div id="user-info" class="nav-utils">
                    <a href="../login/login.html" class="login-btn">로그인</a>
                    <a href="../login/signup.html" class="signup-btn">회원가입</a>
                </div>
            </nav>
        </header>
    
        <!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sample Page with External CSS and JS</title>

    <!-- CSS Links -->
    <link rel="stylesheet" href="https://og-data.s3.amazonaws.com/CACHE2/css/output.0182ddde3c57.css">
    <link rel="stylesheet" href="https://og-data.s3.amazonaws.com/CACHE2/css/output.b23bfaa2a14d.css">
</head>
  
   <div id="contents">
    <section class="pageHead" id="checkout_head">
     <div class="pageHead-bar">
     </div>
     <h2 class="pageHead-title">
      카트
     </h2>
     <div class="pageHead-description">
      Cart
     </div>
     <div id="checkoutSteps">
      <span class="checkoutStep checkoutStep-bold">
       1. 카트
      </span>
      <span class="checkoutStep">
       2. 주문결제
      </span>
      <span class="checkoutStep">
       3. 주문완료
      </span>
     </div>
    </section>
    <nav class="cf" id="cartNav">
     <div class="cartNav-btn cartNav-btn-current">
      렌탈 (0)
     </div>
     <a class="cartNav-btn" href="/cart/purchasecart.html">
      구매 (0)
     </a>
     
    </nav>
    <section id="cartBody">
     <form action="checkout.html" id="cartForm" method="post">
      <input name="csrfmiddlewaretoken" type="hidden" value="2ur7kIDlyPGXAs6YbjXvNlIscyNkMm2ahIcaZZoZQbLaB3klyuuuB3HySOtSCiJL"/>
      <input name="order_type" type="hidden" value="R"/>
      <table id="cartList">
       <thead>
        <tr>
         <th class="cartList-checkbox" scope="col">
          <input class="cartList-checkAll" id="cartList-checkAll-1" type="checkbox"/>
          <label for="cartList-checkAll-1">
          </label>
         </th>
         <th class="cartList-thInfo" scope="col">
          작품정보
         </th>
         <th class="cartList-thPrice" scope="col">
          렌탈요금
         </th>
         <th class="cartList-thRemove" scope="col">
         </th>
        </tr>
       </thead>
       <tbody>
        <tr>
         <td class="cartList-checkbox">
          <input checked="checked" class="cartList-checkEach" data-amount="69000" data-code="A1166-0001" id="cartList-checkEach-1" name="order_artwork" type="checkbox" value="40315">
           <label for="cartList-checkEach-1">
           </label>
          </input>
         </td>
         <td class="cartList-tdInfo">
          <a class="cartList-imageHolder" href="/artwork/A1166-0001/">
            <img class="cartList-image" src="${item.image_url}" alt="${item.product_name}" />
          </a>
          <div class="cartList-info">
           <p class="cartList-info-code">
            <a href="/artist/A1166/#artworks">
             김보선
            </a>
           </p>
           <p class="cartList-info-title">
            <a href="/artwork/A1166-0001/">
             동경
            </a>
           </p>
           <p class="cartList-info-extra">
            <a href="/artwork/A1166-0001/">
             A1166-0001
            </a>
            <span class="cartList-info-slash">
             /
            </span>
            45x91cm (변형 20호)
           </p>
           <p class="cartList-info-price">
            ￦ 69,000
            <span class="cartList-info-price-sm">
             /월
            </span>
           </p>
          </div>
         </td>
         <td class="cartList-tdPrice">
          ￦ 69,000
          <span class="cartList-tdPrice-sm">
           /월
          </span>
         </td>
         <td class="cartList-tdRemove">
          <input class="cartList-removeEach" onclick="opg.fn.remove_from_cart('r', 'A1166-0001');" type="button" value="삭제"/>
         </td>
        </tr>
       </tbody>
       <tfoot>
        <tr>
         <td class="cartList-checkbox">
          <input class="cartList-checkAll" id="cartList-checkAll-2" type="checkbox"/>
          <label for="cartList-checkAll-2">
          </label>
         </td>
         <td colspan="2">
          <input class="cartList-function" id="cartList-function-remove" type="button" value="삭제"/>
          <input class="cartList-function" id="cartList-function-collect" type="button" value="마이컬렉션에 추가"/>
         </td>
         <td class="cartList-tdDummy">
         </td>
        </tr>
       </tfoot>
      </table>
      <div class="cf" id="cartBoard">
       <ul id="cartBoard-ul">
        <li class="cartBoard-li cf">
         <span class="cartBoard-label">
          작품수
         </span>
         <span class="cartBoard-value">
          <span id="cartBoard-val-artworkCount">
           0
          </span>
          점
         </span>
        </li>
        <li class="cartBoard-li cf">
         <span class="cartBoard-label">
          렌탈기간
         </span>
         <span class="cartBoard-value">
          3개월(90일)
         </span>
        </li>
        <li class="cartBoard-li cf">
         <span class="cartBoard-label">
          렌탈요금
         </span>
         <span class="cartBoard-value">
          ￦
          <span id="cartBoard-val-amount">
           0
          </span>
          /월
         </span>
        </li>
        <li class="cartBoard-li cf">
         <span class="cartBoard-label" onclick="opg.fn.noticePopup('https://og-data.s3.amazonaws.com/static/pages/img/service/cart/shipping-fee_767_320_190730.png');">
          출장비
          <div class="icon-info-18dp">
          </div>
         </span>
         <span class="cartBoard-value">
          작품 크기, 출장 지역에 따라 변동
         </span>
        </li>
        <li class="cartBoard-li cf">
         <span class="cartBoard-label" onclick="opg.fn.noticePopup('https://og-data.s3.amazonaws.com/static/pages/img/service/cart/installation-expenses_767_320.png');">
          설치비
          <div class="icon-info-18dp">
          </div>
         </span>
         <span class="cartBoard-value">
          설치 방식에 따라 변동
         </span>
        </li>
       </ul>
      </div>
      <div id="cartNotice">
       <p>
        렌탈기간은 기본 3개월(90일)입니다. 렌탈요금은 매월, 총 3회 청구됩니다.
       </p>
       <p>
        출장비와 설치비는 지역, 작품 크기, 작품 수 등에 따라 달라지며, 별도 청구됩니다.
       </p>
       <p>
        설치비는 방법에 따라 변동되며, 결제하신 카드로 자동결제 됩니다.
       </p>
       <p>
        작품에 따라 액자가 포함될 수 있습니다.
       </p>
      </div>
      <div id="cartBottom">
       <a href="../product/discover.html">
        <input class="cartBottom-btn" id="toDiscoverBtn" type="button" value="작품 더 고르기"/>
       </a>
       <a href="checkout.html?cart_type=rental" id="toCheckoutLink">
        <input class="cartBottom-btn" id="toCheckoutBtn" type="button" value="주문결제" />
        </a>
      </div>
     </form>
    </section>
   </div>
   <footer id="footer">
    <div class="cf" id="footer-block">
     <div class="footer-link">
      <a href="/about/" onclick="gaFooterAction('footer_company_190208');">
       <span>
        회사소개
       </span>
      </a>
      <a href="/contactus/" onclick="gaFooterAction('footer_cooperate_190208');">
       <span>
        제휴문의
       </span>
      </a>
      <a href="/artist-registry/" onclick="gaFooterAction('footer_artist_register_190208');">
       <span>
        작가공모 지원
       </span>
      </a>
      <a href="/inquire-certificate/">
       <span>
        진품보증서 조회
       </span>
      </a>
     </div>
     <div class="footer-contact">
      <div class="footer-num">
       <a href="tel:1668-1056" onclick="gaFooterAction('footer_contact_tel1668-1056');">
        대표번호 1668-1056
       </a>
       <span class="footer-date">
        평일
       </span>
       <span class="footer-on">
        9:00 - 18:00
       </span>
      </div>
      <div class="footer-contact-sns">
       <div class="footer-cell-foot" id="footer-contact-items">
        <a class="footer-contact-icon" href="https://pf.kakao.com/_xdWtxbl" id="footer-contact-kakaotalk" onclick="gaFooterAction('footer_icon_kakao_190208');" target="_blank">
        </a>
        <a class="footer-contact-icon" href="https://www.instagram.com/opengallery.co.kr/" id="footer-contact-instagram" onclick="gaFooterAction('footer_icon_insta_190208');" target="_blank">
        </a>
        <a class="footer-contact-icon" href="https://post.naver.com/open_gallery" id="footer-contact-naverpost" onclick="gaFooterAction('footer_icon_naverpost_190208');" target="_blank">
        </a>
       </div>
      </div>
     </div>
     <div id="footer-company-info">
      상호명 : 오픈갤러리
      <span class="footer-bar">
       I
      </span>
      대표 : 박의규
      <span class="footer-bar footer-none3">
       I
      </span>
      <br class="footer-visible"/>
      사업자등록번호 : 206-86-83224
      <span class="footer-bar footer-none">
       I
      </span>
      <span class="footer-bar footer-visible">
       I
      </span>
      <br class="footer-none2 footer-none3"/>
      호스팅 제공자 : AWS
      <span class="footer-bar footer-none2 footer-none3">
       I
      </span>
      <br class="footer-none"/>
      <br class="footer-visible"/>
      통신판매신고번호 : 제2019-서울성동-01759호
      <br class="footer-none2"/>
      <span class="footer-bar footer-none">
       I
      </span>
      주소 : 서울 성동구 성수동1가 656-75 헤이그라운드 서울숲점 8층
      <br/>
      E-mail: contact@opengallery.co.kr
      <span class="footer-bar footer-none3">
       I
      </span>
      <br class="footer-visible"/>
      <span class="footer-inc">
       © OPEN GALLERY, Inc.
      </span>
      <br class="footer-none2"/>
      <div class="footer-policy">
       <a href="/terms_and_policy/">
        <span>
         이용약관
        </span>
       </a>
       <a href="/terms_and_policy/">
        <span class="white">
         개인정보처리방침
        </span>
       </a>
       <a href="/faq/">
        <span>
         FAQ
        </span>
       </a>
      </div>
     </div>
    </div>
    <div id="footer-awards">
     <div class="owl-carousel" id="footer-awards-inner">
      <div class="footer-award-item award01">
      </div>
      <div class="footer-award-item award02">
      </div>
      <div class="footer-award-item award03">
      </div>
      <div class="footer-award-item award04">
      </div>
      <div class="footer-award-item award05">
      </div>
      <div class="footer-award-item award06">
      </div>
      <div class="footer-award-item award07">
      </div>
      <div class="footer-award-item award08">
      </div>
      <div class="footer-award-item award09">
      </div>
      <div class="footer-award-item award10">
      </div>
      <div class="footer-award-item award11">
      </div>
      <div class="footer-award-item award12">
      </div>
      <div class="footer-award-item award13">
      </div>
      <div class="footer-award-item award14">
      </div>
     </div>
    </div>
   </footer>
   <div id="recentArtworksPopup">
   </div>
   <div id="basePage-recentArtworks" onclick="gaClickRecentViewed('layer_recently');">
   </div>
   <a href="https://pf.kakao.com/_xdWtxbl/chat?referer=https%3A//www.opengallery.co.kr/cart/rental/" id="kakaoPlusBtn" target="_blank">
    <img src="https://og-data.s3.amazonaws.com/static/common/img/web-kakao-chat%402x.png"/>
   </a>
   <div id="basePage-up">
   </div>
  </div>
  <script src="https://og-data.s3.amazonaws.com/static/common/js/jquery-1.12.4.min.js">
  </script>
  <script src="https://og-data.s3.amazonaws.com/CACHE2/js/output.305063b03c50.js">
  </script>
  <!-- Facebook Pixel Code -->
  <script>
   !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
            n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
            n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
            t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
            document,'script','//connect.facebook.net/en_US/fbevents.js');

            fbq('init', '396355217200403', {
                em: 'tjsghkwlsgh@naver.com',
                ge: 'm',
                db: '20000320'
            });
            fbq('track', 'PageView', null, { eventID: '1731581915086-p910' });
  </script>
  <noscript>
   <img height="1" src="https://www.facebook.com/tr?id=396355217200403&amp;ev=PageView&amp;noscript=1" style="display: none;" width="1"/>
  </noscript>
  <!-- End Facebook Pixel Code -->
  <!-- AppsFlyer in-app event tracking start -->
  <script>
   if ((deviceType === 1 || deviceType === 2) && window.ReactNativeWebView && window.ReactNativeWebView.postMessage) {
                    appEventPush = function (container) {
                        var key, obj, eventName, eventValues,
                            result = {};

                        if (typeof container !== 'object' || container === null) {
                            return;
                        }

                        for (key in container) {
                            if (container.hasOwnProperty(key) && (key === 'appsflyer' || key === 'firebase')) {
                                obj = container[key];

                                if (typeof obj !== 'object' || obj === null || !obj.hasOwnProperty('eventName')) {
                                    break;
                                }

                                eventName = obj.eventName;
                                if (typeof eventName !== 'string' || eventName === '') {
                                    return;
                                }

                                eventValues = Object.assign({
                                    url: (location.pathname + location.search).substring(0, 100)
                                }, obj);
                                delete eventValues.eventName;

                                result[key] = {
                                    eventName: eventName,
                                    eventValues: eventValues,
                                    userId: ogUserKey || null
                                };
                            }
                        }

                        if (Object.keys(result).length !== 0) {
                            window.ReactNativeWebView.postMessage(JSON.stringify(result));
                        }
                    };
                } else {
                    appEventPush = function () {};
                }
            
            appEventPush({
                appsflyer: {
                    eventName: 'af_page_view'
                }
            });
  </script>
  <!-- AppsFlyer in-app event tracking end -->
  <script>
   function gaHeaderAction(label) {
                dataLayer.push({ event: 'header_action', eventLabel: label });
            }

            function gaFooterAction(label) {
                dataLayer.push({ event: 'footer_action', eventLabel: label });
            }

            function gaClickRecentViewed(label, artworkCode) {
                dataLayer.push({ event: 'click_in_RecentlyView', eventLabel: label, artworkCode: artworkCode });
            }

            function gaEventAction(label, eventRequestId) {
                if (eventRequestId) {
                    dataLayer.push({ event: 'event_action_with_id', eventLabel: label, eventRequestId: eventRequestId });
                }
                else {
                    dataLayer.push({ event: 'event_action', eventLabel: label });
                }
            }

            function gaEventLanding(label) {
                dataLayer.push({ event: 'event_landing', eventLabel: label });
            }
  </script>
  <script>
   if (!djContext) var djContext = {};
        djContext.checkout_error = '';
  </script>
  <script src="https://og-data.s3.amazonaws.com/CACHE2/js/output.b5d65a1b1be6.js">
  </script>
  <!-- Naver Analytics -->
  <script src="https://wcs.naver.net/wcslog.js">
  </script>
  <script>
   let wcsPageViewInitiated = false;
            const _nasa = {};

            function naverConversion(type, amount) {
                if (!window.wcs) return;

                // 1: 구매완료, 2: 회원가입, 3: 장바구니 담기, 4: 신청/예약, 5: 기타}
                type = [1, 2, 3, 4].indexOf(type) > -1 ? type : 5;
                amount = amount || 0;

                _nasa.cnv = wcs.cnv(String(type), String(amount));

                if (wcsPageViewInitiated) {
                    wcs.inflow();
                    wcs_do(_nasa);
                }
            }

            window.wcs_add = window.wcs_add || {};
            wcs_add.wa = 's_4c869ed9ab7b';

            $(document).ready(function () {
                if (!window.wcs) return;

                wcs.inflow();
                wcs_do(_nasa);
                wcsPageViewInitiated = true;
            });
  </script>
  <!-- End Naver Analytics -->
  <script>
   $(document).ready(function () {
                
                
            });
  </script>
  <!-- Beusably Tracking Code for https://www.opengallery.co.kr -->
  <script>
   (function (w, d, a) {
                    w.__beusablerumclient__ = {
                        load: function (src) {
                            var b = d.createElement('script');
                            b.src = src;
                            b.async = true;
                            b.type = 'text/javascript';
                            d.getElementsByTagName('head')[0].appendChild(b);
                        }
                    };
                    w.__beusablerumclient__.load(a + '?url=' + encodeURIComponent(d.URL));
                })(window, document, '//rum.beusable.net/load/b190103e130231u268');
  </script>
  <!-- END || Beusably Tracking Code for https://www.opengallery.co.kr-->
  <!-- Daum Kakao Analytics -->
  <script charset="UTF-8" src="//t1.daumcdn.net/adfit/static/kp.js">
  </script>
  <script>
   kakaoPixel('1052010801340985911').pageView();
  </script>
  <!-- End Daum Kakao Analytics -->
 </body>
</html>
  <!-- End Daum Kakao Analytics -->

  <!-- <script src="https://og-data.s3.amazonaws.com/static/common/js/jquery-1.12.4.min.js"></script>
    <script src="https://og-data.s3.amazonaws.com/CACHE2/js/output.305063b03c50.js"></script>
    <script src="https://og-data.s3.amazonaws.com/CACHE2/js/output.b5d65a1b1be6.js"></script>
    <script src="https://wcs.naver.net/wcslog.js"></script>
    <script src="//t1.daumcdn.net/adfit/static/kp.js"></script> -->
 </body>
</html>
<footer>
    <div class="container2">
        <p>&copy; 2024 ADAM(아트를담다). All rights reserved.</p>
    </div>
</footer>
<script src="cart.js"></script>
<script src="../Main/script.js"></script>
<script>
    fetch('/session-user')
        .then(response => response.json())
        .then(data => {
            const userInfo = document.getElementById('user-info');
            if (data.userName) {
                userInfo.innerHTML = `
                    <div class="user-info-container">
                        <span class="username">${data.userName}</span>
                        <form action="/logout" method="POST" class="logout-form">
                            <button type="submit">로그아웃</button>
                        </form>
                    </div>`;
            } else {
                userInfo.innerHTML = `
                    <a href="../login/login.html">로그인</a> 
                    <a href="../login/signup.html">회원가입</a>`;
            }
        })
        .catch(error => console.error('세션 정보를 가져오는 중 오류 발생:', error));
</script>
<script>
        // Fetch rental cart data and dynamically populate the table
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/rental-cart')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // Update the artwork count
                        const artworkCountElement = document.getElementById('cartBoard-val-artworkCount');
                        artworkCountElement.textContent = data.totalArtworkCount;
        
                        // Update the total rental cost
                        const rentalAmountElement = document.getElementById('cartBoard-val-amount');
                        rentalAmountElement.textContent = data.totalRentalCost.toLocaleString(); // Format as currency
        
                        // Populate the cart table
                        const tbody = document.querySelector('#cartList tbody');
                        tbody.innerHTML = ''; // Clear existing rows
        
                        data.data.forEach(item => {
                            const row = document.createElement('tr');
                            row.innerHTML = `
                                <td class="cartList-checkbox">
                                    <input type="checkbox" class="cartList-checkEach" value="${item.product_id}">
                                </td>
                                <td class="cartList-tdInfo">
                                    <a class="cartList-imageHolder" href="/product/${item.product_id}">
                                        <img class="cartList-image" src="${item.image_url}" alt="${item.product_name}" />
                                    </a>
                                    <div class="cartList-info">
                                        <p>${item.product_name}</p>
                                        <p>￦${item.price.toLocaleString()}</p>
                                    </div>
                                </td>
                                <td class="cartList-tdPrice">￦${item.price.toLocaleString()}</td>
                                <td class="cartList-tdRemove">
                                    <button onclick="removeFromCart('${item.product_id}')">X</button>
                                </td>
                            `;
                            tbody.appendChild(row);
                        });
                    } else {
                        alert(data.message || 'Failed to load cart data.');
                    }
                })
                .catch(error => console.error('Error fetching rental cart data:', error));
        });

        // Function to remove an item from the cart
        function removeFromCart(productId) {
            fetch('/remove-from-cart', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ product_id: productId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Item removed successfully.');
                    location.reload(); // Reload the page to refresh the cart
                } else {
                    alert(data.message || 'Failed to remove item.');
                }
            })
            .catch(error => console.error('Error removing item from cart:', error));
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/cart-counts')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        // 렌탈 및 구매 개수 업데이트
                        const rentalCountElement = document.querySelector('.cartNav-btn-current');
                        const purchaseCountElement = document.querySelector('a[href="/cart/purchasecart.html"]');
        
                        rentalCountElement.innerHTML = `렌탈 (${data.rentalCount})`;
                        purchaseCountElement.innerHTML = `구매 (${data.purchaseCount})`;
                    } else {
                        console.error('Failed to fetch cart counts:', data.message);
                    }
                })
                .catch(error => console.error('Error fetching cart counts:', error));
        });
    </script>